<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="utf-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;Gas Bidding – Cheapest Combo (Price per MMSCF)&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>:root {</p>
<p class="p1"><span class="Apple-converted-space">      </span>--bg: #0f172a; <span class="Apple-converted-space">      </span>/* slate-900 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--card: #111827; <span class="Apple-converted-space">    </span>/* gray-900 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--muted: #1f2937;<span class="Apple-converted-space">    </span>/* gray-800 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--text: #e5e7eb; <span class="Apple-converted-space">    </span>/* gray-200 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--sub: #9ca3af;<span class="Apple-converted-space">      </span>/* gray-400 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--accent: #22c55e; <span class="Apple-converted-space">  </span>/* green-500 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--accent-2: #3b82f6; /* blue-500 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--danger: #ef4444; <span class="Apple-converted-space">  </span>/* red-500 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--warning: #f59e0b;<span class="Apple-converted-space">  </span>/* amber-500 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--border: #374151; <span class="Apple-converted-space">  </span>/* gray-700 */</p>
<p class="p1"><span class="Apple-converted-space">      </span>--focus: #93c5fd;<span class="Apple-converted-space">    </span>/* blue-300 */</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>* { box-sizing: border-box; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>html, body { height: 100%; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>body {</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: linear-gradient(180deg, #0b1220, var(--bg));</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: var(--text);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.container {</p>
<p class="p1"><span class="Apple-converted-space">      </span>max-width: 1100px; margin: 32px auto; padding: 0 16px;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.card {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: rgba(17, 24, 39, 0.85);</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: 1px solid var(--border);</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-radius: 16px; padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: 0 10px 30px rgba(0,0,0,0.35);</p>
<p class="p1"><span class="Apple-converted-space">      </span>backdrop-filter: blur(6px);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>h1 { font-size: 1.6rem; margin: 0 0 10px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.sub { color: var(--sub); font-size: 0.95rem; margin-bottom: 16px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.grid {</p>
<p class="p1"><span class="Apple-converted-space">      </span>display: grid; grid-template-columns: repeat(12, 1fr); gap: 12px;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.row { display: flex; gap: 8px; flex-wrap: wrap; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>label { font-size: 0.9rem; color: var(--sub); }</p>
<p class="p1"><span class="Apple-converted-space">    </span>input[type="text"], input[type="number"] {</p>
<p class="p1"><span class="Apple-converted-space">      </span>width: 100%; padding: 10px 12px; border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: 1px solid var(--border); background: var(--muted); color: var(--text);</p>
<p class="p1"><span class="Apple-converted-space">      </span>outline: none;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>input[type="number"]::-webkit-outer-spin-button,</p>
<p class="p1"><span class="Apple-converted-space">    </span>input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>input:focus { border-color: var(--focus); box-shadow: 0 0 0 3px rgba(59,130,246,0.25); }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.btn {</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: 1px solid var(--border); background: #0b1324; color: var(--text);</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 10px 14px; border-radius: 10px; cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.btn:hover { border-color: var(--accent-2); }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.btn.primary { background: var(--accent-2); border-color: var(--accent-2); color: white; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.btn.success { background: var(--accent); border-color: var(--accent); color: #08140a; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.btn.danger { background: var(--danger); border-color: var(--danger); color: white; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.btn.warning { background: var(--warning); border-color: var(--warning); color: #1a1203; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.btn.ghost { background: transparent; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>table { width: 100%; border-collapse: collapse; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>th, td {</p>
<p class="p1"><span class="Apple-converted-space">      </span>text-align: left; padding: 10px 8px; border-bottom: 1px dashed var(--border);</p>
<p class="p1"><span class="Apple-converted-space">      </span>vertical-align: middle;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>th { color: var(--sub); font-weight: 600; font-size: 0.9rem; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>tr:last-child td { border-bottom: none; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.pill { display: inline-block; padding: 4px 10px; border-radius: 999px; border: 1px solid var(--border); color: var(--sub); }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background: #0b1324; padding: 2px 6px; border-radius: 6px; border: 1px solid var(--border); color: var(--focus); }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.right { text-align: right; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.center { text-align: center; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.mt-8 { margin-top: 16px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.mt-16 { margin-top: 24px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.small { font-size: 0.85rem; color: var(--sub); }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.note { border-left: 3px solid var(--accent-2); padding: 10px 12px; background: #0b1324; border-radius: 8px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.wrap { overflow-x: auto; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.badge-warn { color: #fde68a; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.footer { color: var(--sub); font-size: 0.8rem; text-align: center; margin-top: 18px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.link { color: #93c5fd; text-decoration: none; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.link:hover { text-decoration: underline; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.hidden { display:none; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.num { text-align: right; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h1&gt;Gas Bidding – Cheapest Combo&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="sub"&gt;Enter bids priced &lt;b&gt;per MMSCF&lt;/b&gt;, set a target volume, then compute the least-cost selection.&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="col" style="grid-column: span 3;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;label&gt;Currency label&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;input id="currency" type="text" value="USD" aria-label="Currency label (e.g., USD, RM)" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="col" style="grid-column: span 3;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;label&gt;Target volume (MMSCF)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;input id="target" type="number" min="0" step="0.0001" value="100" aria-label="Target volume in MMSCF" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="col" style="grid-column: span 3;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;label&gt;Round decimals&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;input id="decimals" type="number" min="0" max="6" step="1" value="3" aria-label="Number of decimals" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="col" style="grid-column: span 3; display:flex; align-items:flex-end; gap:8px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button class="btn primary" id="btn-compute" title="Find cheapest combination"&gt;Find Cheapest Combo&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button class="btn ghost" id="btn-clear" title="Clear all rows"&gt;Clear Rows&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mt-16 row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button class="btn" id="btn-add"&gt;Add Row&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;label class="small"&gt;Tip: paste on any cell to auto-fill columns from a comma-separated line (Supplier, PricePerMMSCF, VolumeMMSCF).&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mt-8 wrap"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;table id="bids-table" aria-label="Bids table"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th&gt;#&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th&gt;Supplier&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th class="right"&gt;Price / MMSCF&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th class="right"&gt;Max Volume (MMSCF)&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th class="center"&gt;Keep?&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th class="center"&gt;Remove&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;tbody id="bids-body"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Rows inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mt-8 row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;input type="file" id="csv-input" accept=".csv,text/csv" class="hidden" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button class="btn" id="btn-import"&gt;Import CSV&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button class="btn" id="btn-export"&gt;Export Bids CSV&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mt-16"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button class="btn success" id="btn-export-solution" disabled&gt;Export Solution CSV&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;span class="small"&gt;Columns: Supplier, TakenVolume(MMSCF), UnitPrice(/MMSCF), Cost&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="results" class="mt-8 hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="note"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="status-line"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="totals-line" class="small"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="mt-8 wrap"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;table id="solution-table" aria-label="Solution table"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th&gt;#&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th&gt;Supplier&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th class="right"&gt;Taken (MMSCF)&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th class="right"&gt;Unit Price (/MMSCF)&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th class="right"&gt;Cost&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;tbody id="solution-body"&gt;&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;tfoot&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th colspan="2" class="right"&gt;Totals&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th class="right" id="sol-total-vol"&gt;0&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th&gt;&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th class="right" id="sol-total-cost"&gt;0&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th colspan="2" class="right"&gt;Weighted Avg Price (/MMSCF)&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;th class="right" id="sol-wap" colspan="3"&gt;0&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/tfoot&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mt-16"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;details&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;summary&gt;&lt;span class="pill"&gt;CSV format help&lt;/span&gt;&lt;/summary&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="small" style="margin-top:10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p&gt;CSV columns (no header needed): &lt;code&gt;Supplier, PricePerMMSCF, MaxVolumeMMSCF&lt;/code&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p&gt;Example:&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;pre class="kbd"&gt;Alpha Gas, 10.75, 80</p>
<p class="p1">Beta LNG,<span class="Apple-converted-space">  </span>11.20, 50</p>
<p class="p1">Vittol,<span class="Apple-converted-space">    </span>10.50, 40</p>
<p class="p1">Shell, <span class="Apple-converted-space">    </span>11.00, 100&lt;/pre&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/details&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="footer"&gt;Made for quick gas bid screening (price per MMSCF). No data leaves your browser.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>// ---------- Helpers ----------</p>
<p class="p1"><span class="Apple-converted-space">    </span>const $ = (sel) =&gt; document.querySelector(sel);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const $$ = (sel) =&gt; Array.from(document.querySelectorAll(sel));</p>
<p class="p1"><span class="Apple-converted-space">    </span>const fmt = (n, d=3) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!isFinite(n)) return "—";</p>
<p class="p1"><span class="Apple-converted-space">      </span>const v = Number(n);</p>
<p class="p1"><span class="Apple-converted-space">      </span>return v.toLocaleString(undefined, { maximumFractionDigits: d, minimumFractionDigits: Math.min(d, 3) });</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p1"><span class="Apple-converted-space">    </span>const parseNum = (v) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (typeof v === "number") return v;</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!v) return NaN;</p>
<p class="p1"><span class="Apple-converted-space">      </span>return Number(String(v).replace(/,/g, "").trim());</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// ---------- State ----------</p>
<p class="p1"><span class="Apple-converted-space">    </span>let lastSolution = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// ---------- Row management ----------</p>
<p class="p1"><span class="Apple-converted-space">    </span>function addRow(data = {}) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const tbody = $("#bids-body");</p>
<p class="p1"><span class="Apple-converted-space">      </span>const tr = document.createElement("tr");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>tr.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;td class="center idx"&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;td&gt;&lt;input type="text" placeholder="Supplier" value="${(data.supplier ?? "").toString().replace(/"/g, '&amp;quot;')}" /&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;td class="num"&gt;&lt;input type="number" step="0.0001" min="0" placeholder="Price per MMSCF" value="${data.price ?? ""}" /&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;td class="num"&gt;&lt;input type="number" step="0.0001" min="0" placeholder="Max Volume (MMSCF)" value="${data.volume ?? ""}" /&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;td class="center"&gt;&lt;input type="checkbox" class="keep" ${data.keep === false ? "" : "checked"} title="Uncheck to exclude a row without deleting it" /&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;td class="center"&gt;&lt;button class="btn danger btn-del" title="Remove this row"&gt;Remove&lt;/button&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Paste helper: allow pasting "Supplier, price, volume" into any cell</p>
<p class="p1"><span class="Apple-converted-space">      </span>tr.querySelectorAll("input").forEach(inp =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>inp.addEventListener("paste", (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const text = (e.clipboardData || window.clipboardData).getData("text");</p>
<p class="p1"><span class="Apple-converted-space">          </span>if (text &amp;&amp; text.split(",").length &gt;= 2) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const parts = text.split(",").map(s =&gt; s.trim());</p>
<p class="p1"><span class="Apple-converted-space">            </span>const [supplier, price, volume] = parts;</p>
<p class="p1"><span class="Apple-converted-space">            </span>tr.querySelectorAll("input")[0].value = supplier ?? "";</p>
<p class="p1"><span class="Apple-converted-space">            </span>tr.querySelectorAll("input")[1].value = price ?? "";</p>
<p class="p1"><span class="Apple-converted-space">            </span>tr.querySelectorAll("input")[2].value = volume ?? "";</p>
<p class="p1"><span class="Apple-converted-space">          </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>tr.querySelector(".btn-del").addEventListener("click", () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>tr.remove();</p>
<p class="p1"><span class="Apple-converted-space">        </span>reindex();</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>tbody.appendChild(tr);</p>
<p class="p1"><span class="Apple-converted-space">      </span>reindex();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function reindex() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>$$("#bids-body tr").forEach((tr, i) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const idx = tr.querySelector(".idx");</p>
<p class="p1"><span class="Apple-converted-space">        </span>idx.textContent = String(i + 1);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function readRows() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rows = [];</p>
<p class="p1"><span class="Apple-converted-space">      </span>$$("#bids-body tr").forEach(tr =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const [supplierEl, priceEl, volEl] = tr.querySelectorAll("input");</p>
<p class="p1"><span class="Apple-converted-space">        </span>const keepEl = tr.querySelector(".keep");</p>
<p class="p1"><span class="Apple-converted-space">        </span>const supplier = supplierEl.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">        </span>const price = parseNum(priceEl.value);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const volume = parseNum(volEl.value);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const keep = keepEl.checked;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Allow blank rows to be ignored</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!supplier &amp;&amp; !isFinite(price) &amp;&amp; !isFinite(volume)) return;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>rows.push({ supplier, price, volume, keep });</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>return rows;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function clearRows() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#bids-body").innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">      </span>reindex();</p>
<p class="p1"><span class="Apple-converted-space">      </span>resetResults();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// ---------- CSV I/O ----------</p>
<p class="p1"><span class="Apple-converted-space">    </span>function toCSV(rows) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const esc = (s) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const v = String(s ?? "");</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (v.includes(",") || v.includes('"') || v.includes("\n")) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>return `"${v.replace(/"/g, '""')}"`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>return v;</p>
<p class="p1"><span class="Apple-converted-space">      </span>};</p>
<p class="p1"><span class="Apple-converted-space">      </span>const lines = rows.map(r =&gt; [r.supplier, r.price, r.volume].map(esc).join(","));</p>
<p class="p1"><span class="Apple-converted-space">      </span>return lines.join("\n");</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function fromCSV(text) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Simple CSV parser for 3 columns per line</p>
<p class="p1"><span class="Apple-converted-space">      </span>const lines = text.split(/\r?\n/).map(l =&gt; l.trim()).filter(Boolean);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const parsed = [];</p>
<p class="p1"><span class="Apple-converted-space">      </span>for (const line of lines) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Split by commas not inside quotes</p>
<p class="p1"><span class="Apple-converted-space">        </span>const parts = [];</p>
<p class="p1"><span class="Apple-converted-space">        </span>let cur = "";</p>
<p class="p1"><span class="Apple-converted-space">        </span>let inQ = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>for (let i = 0; i &lt; line.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const ch = line[i];</p>
<p class="p1"><span class="Apple-converted-space">          </span>if (ch === '"') {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (inQ &amp;&amp; line[i+1] === '"') { cur += '"'; i++; }</p>
<p class="p1"><span class="Apple-converted-space">            </span>else inQ = !inQ;</p>
<p class="p1"><span class="Apple-converted-space">          </span>} else if (ch === ',' &amp;&amp; !inQ) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>parts.push(cur); cur = "";</p>
<p class="p1"><span class="Apple-converted-space">          </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">            </span>cur += ch;</p>
<p class="p1"><span class="Apple-converted-space">          </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>parts.push(cur);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const [supplier="", price="", volume=""] = parts.map(s =&gt; s.trim());</p>
<p class="p1"><span class="Apple-converted-space">        </span>parsed.push({</p>
<p class="p1"><span class="Apple-converted-space">          </span>supplier,</p>
<p class="p1"><span class="Apple-converted-space">          </span>price: parseNum(price),</p>
<p class="p1"><span class="Apple-converted-space">          </span>volume: parseNum(volume),</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>return parsed;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function download(filename, text) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const a = document.createElement("a");</p>
<p class="p1"><span class="Apple-converted-space">      </span>a.href = URL.createObjectURL(new Blob([text], { type: "text/plain" }));</p>
<p class="p1"><span class="Apple-converted-space">      </span>a.download = filename;</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.body.appendChild(a);</p>
<p class="p1"><span class="Apple-converted-space">      </span>a.click();</p>
<p class="p1"><span class="Apple-converted-space">      </span>a.remove();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// ---------- Compute cheapest combo ----------</p>
<p class="p1"><span class="Apple-converted-space">    </span>function compute() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>resetResults();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>const currency = $("#currency").value.trim() || "USD";</p>
<p class="p1"><span class="Apple-converted-space">      </span>const decimals = Math.max(0, Math.min(6, parseInt($("#decimals").value || "3", 10)));</p>
<p class="p1"><span class="Apple-converted-space">      </span>const target = parseNum($("#target").value);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>const rows = readRows().filter(r =&gt; r.keep);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const errors = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!isFinite(target) || target &lt;= 0) errors.push("Target volume must be a positive number.");</p>
<p class="p1"><span class="Apple-converted-space">      </span>rows.forEach((r, i) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!r.supplier) errors.push(`Row ${i+1}: Supplier is empty.`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!isFinite(r.price) || r.price &lt; 0) errors.push(`Row ${i+1}: Invalid price.`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!isFinite(r.volume) || r.volume &lt; 0) errors.push(`Row ${i+1}: Invalid volume.`);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>if (rows.length === 0) errors.push("No valid rows to evaluate.");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>if (errors.length) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>showStatus(errors.join(" "), "error");</p>
<p class="p1"><span class="Apple-converted-space">        </span>return;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Sort by ascending unit price</p>
<p class="p1"><span class="Apple-converted-space">      </span>const sorted = rows.slice().sort((a, b) =&gt; a.price - b.price);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>let remaining = target;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const take = [];</p>
<p class="p1"><span class="Apple-converted-space">      </span>for (const r of sorted) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (remaining &lt;= 0) break;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const qty = Math.min(remaining, r.volume);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (qty &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>take.push({</p>
<p class="p1"><span class="Apple-converted-space">            </span>supplier: r.supplier,</p>
<p class="p1"><span class="Apple-converted-space">            </span>unit: r.price,</p>
<p class="p1"><span class="Apple-converted-space">            </span>qty,</p>
<p class="p1"><span class="Apple-converted-space">            </span>cost: qty * r.price</p>
<p class="p1"><span class="Apple-converted-space">          </span>});</p>
<p class="p1"><span class="Apple-converted-space">          </span>remaining -= qty;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>const totalVol = take.reduce((s, x) =&gt; s + x.qty, 0);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const totalCost = take.reduce((s, x) =&gt; s + x.cost, 0);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const wap = totalVol &gt; 0 ? totalCost / totalVol : NaN;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Render solution</p>
<p class="p1"><span class="Apple-converted-space">      </span>const tbody = $("#solution-body");</p>
<p class="p1"><span class="Apple-converted-space">      </span>tbody.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">      </span>take.forEach((x, i) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tr = document.createElement("tr");</p>
<p class="p1"><span class="Apple-converted-space">        </span>tr.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;td class="center"&gt;${i+1}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;td&gt;${x.supplier}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;td class="right"&gt;${fmt(x.qty, decimals)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;td class="right"&gt;${fmt(x.unit, decimals)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;td class="right"&gt;${currency} ${fmt(x.cost, decimals)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>tbody.appendChild(tr);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#sol-total-vol").textContent = fmt(totalVol, decimals);</p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#sol-total-cost").textContent = currency + " " + fmt(totalCost, decimals);</p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#sol-wap").textContent = fmt(wap, decimals);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>const results = $("#results");</p>
<p class="p1"><span class="Apple-converted-space">      </span>results.classList.remove("hidden");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>const shortage = Math.max(0, target - totalVol);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (shortage &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>showStatus(</p>
<p class="p1"><span class="Apple-converted-space">          </span>`Target: &lt;b&gt;${fmt(target, decimals)} MMSCF&lt;/b&gt;. Supply short by &lt;span class="badge-warn"&gt;&lt;b&gt;${fmt(shortage, decimals)} MMSCF&lt;/b&gt;&lt;/span&gt;.`,</p>
<p class="p1"><span class="Apple-converted-space">          </span>"warn"</p>
<p class="p1"><span class="Apple-converted-space">        </span>);</p>
<p class="p1"><span class="Apple-converted-space">      </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">        </span>showStatus(</p>
<p class="p1"><span class="Apple-converted-space">          </span>`Target: &lt;b&gt;${fmt(target, decimals)} MMSCF&lt;/b&gt;. Fully covered by the cheapest combination.`,</p>
<p class="p1"><span class="Apple-converted-space">          </span>"ok"</p>
<p class="p1"><span class="Apple-converted-space">        </span>);</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#totals-line").innerHTML = `Total Cost: &lt;b&gt;${currency} ${fmt(totalCost, decimals)}&lt;/b&gt; &amp;nbsp;•&amp;nbsp; Weighted Avg Price: &lt;b&gt;${fmt(wap, decimals)} / MMSCF&lt;/b&gt;`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>lastSolution = { currency, decimals, target, take, totalVol, totalCost, wap };</p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#btn-export-solution").disabled = take.length === 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function resetResults() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#results").classList.add("hidden");</p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#status-line").innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#totals-line").innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">      </span>lastSolution = null;</p>
<p class="p1"><span class="Apple-converted-space">      </span>$("#btn-export-solution").disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function showStatus(msg, kind="ok") {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const el = $("#status-line");</p>
<p class="p1"><span class="Apple-converted-space">      </span>const icon = kind === "ok" ? "✅" : kind === "warn" ? "⚠️" : "❌";</p>
<p class="p1"><span class="Apple-converted-space">      </span>const color = kind === "ok" ? "var(--accent)" :</p>
<p class="p1"><span class="Apple-converted-space">                    </span>kind === "warn" ? "var(--warning)" : "var(--danger)";</p>
<p class="p1"><span class="Apple-converted-space">      </span>el.innerHTML = `${icon} &lt;span style="color:${color}"&gt;${msg}&lt;/span&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// ---------- Export solution ----------</p>
<p class="p1"><span class="Apple-converted-space">    </span>function exportSolutionCSV() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!lastSolution) return;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const d = lastSolution.decimals ?? 3;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rows = lastSolution.take.map(x =&gt; ({</p>
<p class="p1"><span class="Apple-converted-space">        </span>Supplier: x.supplier,</p>
<p class="p1"><span class="Apple-converted-space">        </span>TakenVolume_MMSCF: Number(x.qty.toFixed(d)),</p>
<p class="p1"><span class="Apple-converted-space">        </span>UnitPrice_per_MMSCF: Number(x.unit.toFixed(d)),</p>
<p class="p1"><span class="Apple-converted-space">        </span>Cost: Number(x.cost.toFixed(d))</p>
<p class="p1"><span class="Apple-converted-space">      </span>}));</p>
<p class="p1"><span class="Apple-converted-space">      </span>const header = Object.keys(rows[0] || {Supplier:"",TakenVolume_MMSCF:"",UnitPrice_per_MMSCF:"",Cost:""}).join(",");</p>
<p class="p1"><span class="Apple-converted-space">      </span>const lines = rows.map(r =&gt; Object.values(r).join(","));</p>
<p class="p1"><span class="Apple-converted-space">      </span>const csv = [header, ...lines].join("\n");</p>
<p class="p1"><span class="Apple-converted-space">      </span>download("gas-bidding-solution.csv", csv);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// ---------- Events ----------</p>
<p class="p1"><span class="Apple-converted-space">    </span>$("#btn-add").addEventListener("click", () =&gt; addRow());</p>
<p class="p1"><span class="Apple-converted-space">    </span>$("#btn-clear").addEventListener("click", clearRows);</p>
<p class="p1"><span class="Apple-converted-space">    </span>$("#btn-compute").addEventListener("click", compute);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>$("#btn-export").addEventListener("click", () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rows = readRows();</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (rows.length === 0) return download("bids.csv", "");</p>
<p class="p1"><span class="Apple-converted-space">      </span>download("bids.csv", toCSV(rows));</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>$("#btn-import").addEventListener("click", () =&gt; $("#csv-input").click());</p>
<p class="p1"><span class="Apple-converted-space">    </span>$("#csv-input").addEventListener("change", async (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const file = e.target.files?.[0];</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!file) return;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const text = await file.text();</p>
<p class="p1"><span class="Apple-converted-space">      </span>const parsed = fromCSV(text);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (parsed.length === 0) return;</p>
<p class="p1"><span class="Apple-converted-space">      </span>clearRows();</p>
<p class="p1"><span class="Apple-converted-space">      </span>parsed.forEach(r =&gt; addRow(r));</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>$("#btn-export-solution").addEventListener("click", exportSolutionCSV);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Seed with sample rows</p>
<p class="p1"><span class="Apple-converted-space">    </span>[</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ supplier: "Alpha Gas", price: 10.75, volume: 80 },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ supplier: "Vittol",<span class="Apple-converted-space">    </span>price: 10.50, volume: 40 },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ supplier: "Shell", <span class="Apple-converted-space">    </span>price: 11.00, volume: 100 },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ supplier: "Beta LNG",<span class="Apple-converted-space">  </span>price: 11.20, volume: 50 }</p>
<p class="p1"><span class="Apple-converted-space">    </span>].forEach(addRow);</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
